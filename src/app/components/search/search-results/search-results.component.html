<aca-page-layout>
  <aca-page-layout-header>
    <adf-breadcrumb root="APP.BROWSE.SEARCH.TITLE"> </adf-breadcrumb>
    <adf-toolbar class="adf-toolbar--inline">
      <ng-container *ngFor="let entry of actions; trackBy: trackByActionId">
<aca-toolbar-action [actionRef]="entry"></aca-toolbar-action>
      </ng-container>
    </adf-toolbar>
  </aca-page-layout-header>

  <aca-page-layout-content>
    <div class="main-content">
      <div class="adf-search-results">
        <adf-search-filter
          #searchFilter
          (click)="onclick()"
          [ngClass]="{
            'adf-search-filter--hidden':
      !(showFacetFilter$ | async)||onclick()
          }"

        ></adf-search-filter>
        <div class="adf-search-results__content">
          <mat-progress-bar
            *ngIf="isLoading"
            color="primary"
            mode="indeterminate"
          >
          </mat-progress-bar>
          <div
            class="adf-search-results__content-header content"
            *ngIf="data?.list.entries.length"
          >
            <div class="content__side--left">
              <div
                class="adf-search-results--info-text"
                *ngIf="totalResults !== 1"
              >
                {{
                'APP.BROWSE.SEARCH.FOUND_RESULTS'
                  | translate: { number: totalResults }
                }}
              </div>
              <div
                class="adf-search-results--info-text"
                *ngIf="totalResults === 1"
              >
                {{
                'APP.BROWSE.SEARCH.FOUND_ONE_RESULT'
                  | translate: { number: totalResults }
                }}
              </div>

              <div class="adf-search-results__facets">
                <adf-search-chip-list
                  [searchFilter]="searchFilter"
                ></adf-search-chip-list>
              </div>

            </div>

            <adf-search-sorting-picker
              [hidden]="count===1"
              class="content__side--right"
            ></adf-search-sorting-picker>
            <div class="modal-footer flex-wrap">

            <button mat-raised-button color="Warn"  (click)="export()" style="margin: 15px; background-color: rgb(251 176 62);color: white" > <mat-icon>description</mat-icon>
              {{'BUTTON.EXPORT-EXCEL' | translate}}</button>
            <button mat-raised-button color="accent"  (click)="generatePdf()"> <mat-icon>picture_as_pdf</mat-icon>
              {{'BUTTON.EXPORT-PDF' | translate}}</button>
            </div>

          </div>
          <adf-document-list
            #documentList
            acaDocumentList
            acaContextActions
            [display]="documentDisplayMode$ | async"
            selectionMode="multiple"
            [sorting]="['modifiedAt', 'desc']"
            [imageResolver]="imageResolver"
            [stickyHeader]=true
            sortingMode="client"
            [node]="data"
            (node-dblclick)="onNodeDoubleClick($event.detail?.node)"
            [hidden]="count===0"
            >
            <div fxLayout="row wrap" fxLayoutAlign="space-between">
              <adf-datatable id="ExampleTable">
            <data-columns>
              <data-column key="$thumbnail" type="image"></data-column>
              <data-column
                title="SEARCH.SORT.RELEVANCE"
                sortable="true"
                key="search.score"
              >
              </data-column>
              <data-column
                title="SEARCH.SORT.FILENAME"
                key="name"
                sortable="true"
                class="adf-grow-cell">
              </data-column>
                            <data-column
                              title="METADATA.BASIC.TITLE"
                              key="properties.cm:title"
                              sortable="true"
                              sortable="true"
                              class="desktop-only">
                            </data-column>
              <data-column
                title="METADATA.BASIC.MODIFIED_DATE"
                sortable="true"
                key="modifiedAt"
                type="date"
                format="dd.MM.yyyy HH:mm "
                class="adf-ellipsis-cell">
              </data-column>
              <data-column
                title="METADATA.BASIC.MODIFIER"
                key="modifiedByUser.displayName"
                sortable="true"
                type="text"
                format="medium"
                class="adf-ellipsis-cell">
              </data-column>
              <data-column
                title="METADATA.BASIC.CREATOR"
                key="createdByUser.displayName"
                sortable="true"
                class="desktop-only">
              </data-column>
              <data-column
                title="METADATA.BASIC.CREATED_DATE"
                sortable="true"
                key="createdAt"
                type="date"
                format="dd.MM.yyyy HH:mm "
                class="desktop-only">
              </data-column>
              <data-column
                title="METADATA.BASIC.SIZE"
                sortable="true"
                key="content.sizeInBytes"
                type="fileSize"
                format="medium"
                class="adf-no-grow-cell adf-ellipsis-cell">
              </data-column>
              <data-column
                title="SEARCH.FACET_FIELDS.FILE_TYPE"
                sortable="true"
                key="content.mimeTypeName"
                type="text"
                class="adf-grow-cell">
              </data-column>

              <data-column
                title="APP.DOCUMENT_LIST.COLUMNS.LOCATION"
                key="path.elements.4.name"
                sortable="true"
                type="text"
                format="/"
                class="adf-grow-cell">
              </data-column>
            </data-columns>
              </adf-datatable>
              <adf-custom-empty-content-template>
              <ng-container>
                <div class="empty-search__block">
                  <p class="empty-search__text">
                    {{ 'APP.BROWSE.SEARCH.NO_RESULTS' | translate }}
                  </p>
                </div>
              </ng-container>
            </adf-custom-empty-content-template>
            </div>
          </adf-document-list>
<!--          Toggle-->
          <adf-document-list
            #documentList
            acaDocumentList
            acaContextActions
            [showHeader]="false"
            [selectionMode]="'multiple'"
            [sortingMode]="'server'"
            [sorting]="sorting"
            [imageResolver]="imageResolver"
            [node]="data"
            (node-dblclick)="onNodeDoubleClick($event.detail?.node)"
            [hidden]="count===1"

          >
            <div fxLayout="row wrap" fxLayoutAlign="space-between">
              <data-columns>
                <data-column
                  [key]="'$thumbnail'"
                  [type]="'image'"
                  [sr-title]="'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL'"
                  [sortable]="false"
                >
                </data-column>
                <data-column key type="text">
                  <ng-template let-context>
                    <aca-search-results-row
                      [context]="context"
                    ></aca-search-results-row>
                  </ng-template>
                </data-column>
              </data-columns>
              <adf-custom-empty-content-template>
                <ng-container>
                  <div class="empty-search__block">
                    <p class="empty-search__text">
                      {{ 'APP.BROWSE.SEARCH.NO_RESULTS' | translate }}
                    </p>
                  </div>
                </ng-container>
              </adf-custom-empty-content-template>
            </div>
          </adf-document-list>

          <button mat-stroked-button color="accent" (click)="loadAllResults()" style="color: white;background-color:#0869b0 " > <mat-icon>cached</mat-icon>{{'BUTTON.Load_All_Results' | translate}}</button>


          <adf-pagination
            *ngIf="documentList"
            acaPagination
            [target]="documentList"
            (change)="onPaginationChanged($event)"
          >

          </adf-pagination>
<!--          <adf-pagination *ngIf="count===1" acaPagination  [target]="documentList"  (change)="onPaginationChanged($event)"> </adf-pagination>-->

        </div>
      </div>
    </div>
    <div class="sidebar" *ngIf="infoDrawerOpened$ | async">
      <aca-info-drawer [node]="selection.last"></aca-info-drawer>

    </div>

  </aca-page-layout-content>
</aca-page-layout>
